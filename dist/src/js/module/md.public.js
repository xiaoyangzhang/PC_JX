/*! pc_jx - v1.0.0 - 2016-07-28 */
define(function(require,exports,module){require("json"),$urlpath=require("urlpath"),$public=function(){Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length)return!1;for(var i=0,n=0;i<this.length;i++)this[i]!=this[dx]&&(this[n++]=this[i]);return this.length-=1,this},String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.LTrim=function(){return this.replace(/(^\s*)/g,"")},String.prototype.RTrim=function(){return this.replace(/(\s*$)/g,"")},this.init.apply(this,arguments)},fileuploadURL=$("#filegw_url").val()+"/",fileCompressURL=$("#filegw_domain").val()+"/",site_path=$("#root_path").val()+"/",img_domain=$("#tfs").val(),static_path=$("#static_path").val(),static_source=static_path?static_path.substring(0,static_path.lastIndexOf("/")+1):static_path,
// fileuploadURL=$urlpath.fileuploadURL,
// site_path=$urlpath.site_path,
// static_path=$urlpath.static_source+'/src',
// img_domain=$urlpath.img_domain,
// static_source=$urlpath.static_source;
$public.prototype={init:function(){var _self=this;/* 统一主域名 */
document.domain.indexOf("jiuxiulvxing.com")!=-1&&(document.domain="jiuxiulvxing.com"),$('textarea,input:not(input[type="radio"],input[type="checkbox"])').on("focus",function(){$(this).css("border","1px solid #ed6c44")}).on("blur",function(){$(this).css("border","1px solid #ddd")}),
//杜绝编辑时自动优先激活验证
setTimeout(function(){_self.isVdSelect=!0},500)},isLogin:function(data){!data instanceof Object&&(data=JSON.parse(data)),22e6==data.errorCode&&(window.location=site_path+"/user/login")},depath:function(){var hh=$("#jiuxColor").height(),fh=$("#footID,.jiux-footer").height(),el=$(".eredar-left"),er=$(".eredar-right"),wdh=$(window).height()-hh-fh-102,auto_height=$(document).height()-hh-fh-60,elh=el.height()+120,erh=er.height();wdh>elh&&wdh>erh?el.height(elh):el.height(auto_height)},urlpath:{eredar:site_path+"/basicInfo/talent/saveTalentInfo",merchant:site_path+"/basicInfo/merchant/saveBasic",updatepwd:site_path+"/account/modifyPassword",gethotelist:site_path+"/hotel/queryHotelManageList",getroominfo:site_path+"/hotel/queryRoomTypeListByData",addhotel:site_path+"/hotel/addHotelMessageVOByData",updatehotel:site_path+"/hotel/editHotelMessageVOByData",getScenicList:site_path+"/scenic/queryScenicManageVOListByData",getScenicTicketType:site_path+"/scenic/queryTicketListByScenicId",addScenic:site_path+"/scenic/addScenicManageVOByDdata",updateScenic:site_path+"/scenic/editScenicManageVOByDdata",getBsScope:site_path+"/apply/getBusinessScope",pageilB:site_path+"/apply/seller/pageDetailB",agreement:site_path+"/apply/talent/agreement",saveSPOTDraft:site_path+"/draft/saveSPOTDraft",toDetailPage:site_path+"/apply/seller/toDetailPage"},timer:null,isVdSelect:!1,dialog:{initbox:function(){var _self=this;clearTimeout(_self.timer),_self.box||($("body").append('<div class="dialog"><div class="bgmeng" style="height:'+$(document).height()+'px"></div></div>'),$(".bgmeng").on("click",function(ev){_self.closebox(),$public.stopBubble(ev)}),_self.box=$(".dialog").height($(window).height()))},closebox:function(){var _self=this;_self.box.hide(),$(".container").children("div").hide().appendTo("body"),$(".bgmeng").off().on("click",function(ev){_self.closebox(),$public.stopBubble(ev)})},waiting:function(){var _self=this;_self.initbox(),"waiting-box"==_self.box.attr("id")?_self.box.fadeIn():($(".bgmeng").off(),_self.box.children(':not(".bgmeng")').remove(),_self.box.attr("id","waiting-box").append('<div class="loading"><img src="'+static_source+'img/loading.gif"><label>请稍后。。。</label></div>').fadeIn())},msg:function(value,type){var _self=this;_self.initbox(),"msg-box"==_self.box.attr("id")?($(".msg").text(value),_self.box.fadeIn()):(_self.box.children(':not(".bgmeng")').remove(),_self.box.attr("id","msg-box").append('<div class="msg">'+value+"</div>").fadeIn()),clearTimeout(_self.timer),_self.timer=setTimeout(function(){_self.closebox()},2e3),"success"==type?$(".msg").css("color","green"):"error"==type&&$(".msg").css("color","red")},content:function(n_width,n_height,title,html_content,callback,init_callback,type){var _self=this,cur_class=type?"prompt-box":"content-box";_self.initbox(),$(".bgmeng").off(),"auto"==n_height&&(n_height=$(window).height()-180),_self.box.attr("id")==cur_class?_self.box.fadeIn():(_self.box.children(':not(".bgmeng")').remove(),_self.box.attr("id",cur_class).append('<div class="'+cur_class+'"></div>').fadeIn(),$("."+cur_class).append('<div class="btn-group"><div><button class="ok">确定</button><button class="cancel">取消</button></div></div>').append('<div class="close-tip clearfix"><i></i><div><h2>'+title+"</h2></div></div>").append('<div class="container"></div>').width(n_width).height(n_height).css({"margin-left":-(n_width/2)+"px","margin-top":-(n_height/2)+"px"}),$(".container").height(n_height-125),$(".ok").off().on("click",function(ev){callback(),$public.stopBubble(ev)}),$(".cancel,.close-tip i").off().on("click",function(ev){_self.closebox(),$public.stopBubble(ev)})),html_content.appendTo($(".container")),init_callback()}},ck_device:function(){var browser={versions:function(){var u=navigator.userAgent;navigator.appVersion;return{//移动终端浏览器版本信息
trident:u.indexOf("Trident")>-1,//IE内核
presto:u.indexOf("Presto")>-1,//opera内核
webKit:u.indexOf("AppleWebKit")>-1,//苹果、谷歌内核
gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,//火狐内核
mobile:!!u.match(/AppleWebKit.*Mobile.*/),//是否为移动终端
ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),//ios终端
android:u.indexOf("Android")>-1||u.indexOf("Linux")>-1,//android终端或uc浏览器
iPhone:u.indexOf("iPhone")>-1,//是否为iPhone或者QQHD浏览器
iPad:u.indexOf("iPad")>-1,//是否iPad
webApp:u.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};if(browser.versions.mobile){//判断是否是移动设备打开。browser代码在下面
var ua=navigator.userAgent.toLowerCase();"micromessenger"==ua.match(/MicroMessenger/i),"weibo"==ua.match(/WeiBo/i),"qq"==ua.match(/QQ/i),browser.versions.ios,browser.versions.android}},paramcompare:function(arr,callback){for(var result={},temp={},i=0;i<arr.length;i++)if(temp[arr[i].name]){var key=arr[i].name,oldvalue=result[key],newvalue=arr[i].value,temp_arr=[];oldvalue.constructor==Array?result[key]=oldvalue.concat(newvalue):(temp_arr.push(oldvalue),temp_arr.push(newvalue),result[key]=temp_arr)}else result[arr[i].name]=arr[i].value,temp[arr[i].name]=!0;return callback instanceof Function&&callback(result),result},
//二级联动
actiondata:function(province,city,is_check){
//加载联动数据
$.ajax({url:static_path+"/js/allcity.js",dataType:"jsonp",jsonpCallback:"callback",success:function(data){setTimeout(function(){function clear_select($obj){$obj.find("li:eq(0)~li").remove(),$obj.filter(function(){$(this).find(".select-button").val($(this).find("li:eq(0)").first().text())}),$obj.find(":hidden").val(""),$obj.next(".Validform_checktip").remove()}$("#"+province).empty().append(_.template($("#province-tpl").html(),data)).children("option").filter(function(){$(this).val()==$(".province_h").val()&&$(this).attr("selected","selected")}),
//渲染下拉框控件 
$("#"+province).selectlist({width:110,onChange:function(){var cur_p=$('input[name="province"]').val();if(cur_p)for(var c_key in data.city)c_key==cur_p&&$("#"+city).empty().append(_.template($("#city-tpl").html(),{city:data.city[c_key]})).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}});else clear_select($("#"+city));is_check||$public.selectvalid(this.element.id)},onSuccess:function(){var cur_value=$("#"+this.element.id+"_").val(),cur_value=cur_value?cur_value:"fail",olis=$("#"+this.element.id).find("li");olis.filter(function(){$(this).attr("data-value")==cur_value&&($(this).trigger("autoclick"),setTimeout(function(){var cur_p=$('input[name="province"]').val();for(var c_key in data.city)c_key==cur_p&&$("#"+city).empty().append(_.template($("#city-tpl").html(),{city:data.city[c_key]})).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}})},100))})}}),$("#"+city).selectlist({width:180})},100)}})},
//三级联动
procityaredata:function(province,city,area,is_check){
//加载联动数据
$.ajax({url:static_path+"/js/allcity.js",dataType:"jsonp",jsonpCallback:"callback",success:function(data){setTimeout(function(){function clear_select($obj){$obj.find("li:eq(0)~li").remove(),$obj.filter(function(){$(this).find(".select-button").val($(this).find("li:eq(0)").first().text())}),$obj.find(":hidden").val(""),$obj.next(".Validform_checktip").remove()}$("#"+province).empty().append(_.template($("#province-tpl").html(),data)).children("option").filter(function(){$(this).val()==$(".province_h").val()&&$(this).attr("selected","selected")}),
//渲染下拉框控件 
$("#"+province).selectlist({width:110,onChange:function(){var cur_p=$('input[name="province"]').val();if(cur_p)for(var c_key in data.city)c_key==cur_p&&$("#"+city).empty().append(_.template($("#city-tpl").html(),{city:data.city[c_key]})).selectlist({width:180,onChange:function(){var cur_c=$('input[name="city"]').val();if(cur_c)for(var c_key in data.area)c_key==cur_c&&$("#"+area).empty().append(_.template($("#area-tpl").html(),{area:data.area[c_key]})).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}});else clear_select($("#"+area));is_check||$public.selectvalid(this.element.id)}});else clear_select($("#"+city+",#"+area));is_check||$public.selectvalid(this.element.id)},onSuccess:function(){var cur_value=$("#"+this.element.id+"_").val(),cur_value=cur_value?cur_value:"fail",olis=$("#"+this.element.id).find("li");olis.filter(function(){$(this).attr("data-value")==cur_value&&($(this).trigger("autoclick"),setTimeout(function(){var cur_p=$('input[name="province"]').val();if(cur_p)for(var c_key in data.city)c_key==cur_p&&$("#"+city).empty().append(_.template($("#city-tpl").html(),{city:data.city[c_key]})).selectlist({width:180,onChange:function(){var cur_c=$('input[name="city"]').val();if(cur_c)for(var c_key in data.area)c_key==cur_c&&$("#"+area).empty().append(_.template($("#area-tpl").html(),{area:data.area[c_key]})).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}});else clear_select($("#"+area));is_check||$public.selectvalid(this.element.id)},onSuccess:function(){var cur_value=$("#"+this.element.id+"_").val(),cur_value=cur_value?cur_value:"fail",olis=$("#"+this.element.id).find("li");olis.filter(function(){$(this).attr("data-value")==cur_value&&($(this).trigger("autoclick"),setTimeout(function(){var cur_c=$('input[name="city"]').val();if(cur_c)for(var c_key in data.area)c_key==cur_c&&$("#"+area).empty().append(_.template($("#area-tpl").html(),{area:data.area[c_key]})).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}});else clear_select($("#"+area))},100))})}});else clear_select($("#"+city+",#"+area))},100))})}}),$("#"+city).selectlist({width:180}),$("#"+area).selectlist({width:180,onChange:function(){is_check||$public.selectvalid(this.element.id)}})},100)}})},
//验证图片盒子
allimgvalid:function($box){var result=!0,obj=null;return $box.length>0&&$box.filter(function(){var isAllowNull=$(this).attr("class").indexOf("allownull")!=-1;obj=$(this).find("input:hidden"),$(this).parent().find(".Validform_checktip").remove(),isAllowNull||(""!=obj.val()?$(this).after('<span class="Validform_checktip Validform_right"></span>'):($(this).after('<span class="Validform_checktip Validform_wrong">请选择图片！</span>'),result=!1))}),result},
//验证图片盒子
groupimgvalid:function($box,msg){if($box.length>0){var $files=$box.find(":hidden"),isAllowNull=$box.attr("class").indexOf("allownull")!=-1;if($box.find(".Validform_checktip").remove(),isAllowNull)
// var errortip=$box.find('.Validform_wrong').length;
// if(errortip)
// 	return false;
return!0;for(var i=0;i<$files.length;i++)if(""!=$files[i].value)return $box.append('<span class="Validform_checktip Validform_right"></span>'),!0;return $box.append('<span class="Validform_checktip Validform_wrong">'+(msg?msg:"")+"</span>"),!1}return!0},
//验证下拉框
selectvalid:function(id){var result=!0,$droplist=null;return this.isVdSelect&&($droplist=id?$('input[name="'+id+'"]'):$(".select-wrapper input:hidden"),$droplist.filter(function(){var $droplistprent=$(this).closest(".select-wrapper");$droplistprent.next(".Validform_checktip").remove(),""!=$(this).val()?($droplistprent.find(".select-button").css("background","#fff"),$droplistprent.after('<span class="Validform_checktip Validform_right Select_tip"></span>')):($droplistprent.find(".select-button").css("background","#ffe7e7"),$droplistprent.after('<span class="Validform_checktip Validform_wrong Select_tip"></span>'),result=!1)})),result},
//判断上传文件格式是否满足条件
isPicture:function(file,sz){var result={content:"文件类型不合法,只能是jpg、png、jpeg类型！"},fileName=file.value,szcontent={status:!0,content:"文件大小不能超过"+sz+(sz<10?"M":"K")},maxsize=sz<10?1024*sz*1024:1024*sz,filesize=0;//M;
if("I"!=this.diffBrowser().substring(0,1)&&(filesize=file.files[0].size,filesize>maxsize))return szcontent.status=!1,szcontent;if(null!=fileName&&""!=fileName)
//lastIndexOf如果没有搜索到则返回为-1
if(fileName.lastIndexOf(".")!=-1){var fileType=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length).toLowerCase(),suppotFile=new Array;suppotFile[0]="jpg",suppotFile[2]="png",suppotFile[3]="jpeg";for(var i=0;i<suppotFile.length;i++)if(suppotFile[i]==fileType)return result.status=!0,result;result.status=!1}else result.status=!1;else result.status=!0;return result},stopBubble:function(ev){var e=ev||window.event||arguments.callee.caller.arguments[0];
//一般用在鼠标或键盘事件上
e&&e.stopPropagation?
//W3C取消冒泡事件
e.stopPropagation():
//IE取消冒泡事件
window.event.cancelBubble=!0},stopDefault:function(ev){var e=ev||window.event||arguments.callee.caller.arguments[0];
//阻止默认浏览器动作(W3C) 
e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1},dateFormat:function(date,format){format=format||"yyyy-MM-dd hh:mm:ss";var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};/(y+)/.test(format)&&(format=format.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(format)&&(format=format.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return format},setCookie:function(name,value){var Days=30,exp=new Date;exp.setTime(exp.getTime()+24*Days*60*60*1e3),document.cookie=name+"="+escape(value)+";expires="+exp.toGMTString()},getCookie:function(name){var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");return(arr=document.cookie.match(reg))?unescape(arr[2]):null},delCookie:function(name){var exp=new Date;exp.setTime(exp.getTime()-1);var cval=getCookie(name);null!=cval&&(document.cookie=name+"="+cval+";expires="+exp.toGMTString())},diffBrowser:function(){
//使用IE条件注释来判断是否IE6，通过判断userAgent不一定准确
//if (document.all) document.write('<!--[if lte IE 6]><script type="text/javascript">window.ie6= true<\/script><![endif]-->');
var userAgent=navigator.userAgent,//取得浏览器的userAgent字符串
isOpera=userAgent.indexOf("Opera")>-1,//判断是否Opera浏览器
ua=navigator.userAgent.toLowerCase(),rMsie=/(msie\s|trident.*rv:)([\w.]+)/,isIE=null!=rMsie.exec(ua),//判断是否IE浏览器
isFF=userAgent.indexOf("Firefox")>-1,//判断是否Firefox浏览器
isSafari=userAgent.indexOf("Safari")>-1,//判断是否Safari浏览器
isChrome=userAgent.indexOf("Chrome")>-1;//判断是否Chrome浏览器
if(isIE){var reIE=(IE55=IE6=IE7=IE8=IE9=!1,new RegExp("MSIE (\\d+\\.\\d+);"));reIE.test(userAgent);var fIEVersion=parseFloat(RegExp.$1),IE55=5.5==fIEVersion,IE6=6==fIEVersion,IE7=7==fIEVersion,IE8=8==fIEVersion,IE9=9==fIEVersion;return IE55?"IE55":IE6?"IE6":IE7?"IE7":IE8?"IE8":IE9?"IE9":"IE"}return isFF?"FF":isOpera?"Opera":isChrome?"Chrome":isSafari?"Safari":void 0},uploadPic:function(picId,fileId){var pic=document.getElementById(picId),file=document.getElementById(fileId);if(window.FileReader)oFReader=new FileReader,oFReader.readAsDataURL(file.files[0]),oFReader.onload=function(oFREvent){pic.src=oFREvent.target.result};else if(document.all){file.select();var reallocalpath=document.selection.createRange().text;window.ie6?pic.src=reallocalpath:(pic.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image',src=\""+reallocalpath+'")',pic.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==")}else file.files&&file.files.item(0)&&(url=file.files.item(0).getAsDataURL(),pic.src=url)},html_encode:function(str){var s="";return 0==str.length?"":(s=str.replace(/&/g,"&amp;"),s=s.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"),s=s.replace(/ /g,"&nbsp;"),s=s.replace(/\'/g,"&#39;"),s=s.replace(/\"/g,"&quot;"),s=s.replace(/\n|\r\n/g,"<br>"))},html_decode:function(str){var s="";return 0==str.length?"":(s=str.replace(/&amp;/g,"&"),s=s.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"),s=s.replace(/&nbsp;/g," "),s=s.replace(/&#39;/g,"'"),s=s.replace(/&quot;/g,'"'),s=s.replace(/<br>/g,"\n"))}},module.exports=new $public});
/*! pc_jx 最后修改于： 2016-07-28 */