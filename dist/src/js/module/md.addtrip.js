/*! PC_JX - v1.0.0 - 2016-11-01 */
define(function(require,exports,module){var a=require("public"),b=require("cus_datepicker"),c=function(){this.init.apply(this,arguments)};c.prototype={config:{eredarli:".eredar-info li",priceInfo:".price-info",eredarli:".eredar-info li",eredarpanel:".eredar-right .tab-content > .panel"},init:function(){var a=this;a.tabSwitch(),a.addPackage(),a.delTc(),a.tcTabSwitch(),b.dateRender(b.supplierCalendar)},tabSwitch:function(){var a=this;$(a.config.eredarli).on("click",function(b){$(a.config.eredarli).removeClass("on"),$(this).addClass("on"),$(a.config.eredarpanel).hide(),$($(a.config.eredarpanel)[$(this).index()]).fadeIn()})},addPackage:function(){var b=this,c=$(b.config.priceInfo),d=c.find(".package-name");c.on("click",".add-package",function(e){var f=c.find(".btn-outline").length;return f>20?void a.dialog.msg("最多可添加20个套餐","error"):void a.dialog.content(500,200,"添加套餐",d.show(),function(){var e=d.find(".tc-name"),g="",h=$(".add-tc");return e.val()?(f+=1,g=$('<a href="javascript:;" rId='+f+' class="btn btn-outline posr ml10">'+e.val()+'<i class="icon-close"></i></a>'),h.append(g),c.find(".btn-outline").removeClass("active"),g.addClass("active"),b.tcTabSwitch(),$(".tc-tab-content").show(),$(".tc-tab-content .inputxt").val(e.val()),e.val(""),$(".day .choiced").removeClass("choiced").find(".tipvl").remove(),$(".setvalue input").val(""),a.dialog.closebox(),!1):void alert("请输入套餐名称")},function(){})})},tcTabSwitch:function(){var b=this,c=$(b.config.priceInfo);c.on("click",".btn-outline",function(b){var d=$(this),e=d.index()-1,f=c.find(".btn-outline");dataTc=d.attr("data-tc")&&JSON.parse(d.attr("data-tc")),d.hasClass("active")||(f.removeClass("active").eq(e).addClass("active"),$(".datepicker td").removeClass("choiced").find(".tipvl").remove(),dataTc?$.each(dataTc.months,function(b,c){$.each(c.days,function(b,c){var d=a.dateFormat(new Date(c.time),"yyyy-MM-dd").split("-"),e=c.blocks,f="",g="",h="";$("#SY").text(d[0]),$(".datepicker .tdmonth li").each(function(){var a=$(this);a.text().indexOf(d[1])!=-1&&a.addClass("on").html(a.text())}),$(".datepicker td").each(function(){var a=$(this),b=$(this).find("font"),c="";b.text().indexOf(d[2])!=-1&&(a.closest("td").addClass("choiced"),$.each(e,function(b,d){f=d.pTxt,g=d.price,h=d.stock,0==a.find(".tipvl").length?a.find(".dtbx").append('<div class="tipvl"><label>'+f+'￥</label><label class="price_">'+g+'</label><br><label>库</label><label class="stock_">'+h+"</label></div>"):(c+="<br><label>"+f+'￥</label><label class="price_">'+g+"</label>",h&&(c+='<br><label>库</label><label class="stock_">'+h+"</label>"))}),a.find(".tipvl").append(c))})})}):$(".tc-tab-content .inputxt").val(d.text()),a.stopBubble(b))})},delTc:function(){var b=this,c=$(b.config.priceInfo);c.on("click",".icon-close",function(b){var c=this;a.dialog.content(500,200,"添加套餐",$('<div class="mt30">是否确认删除该套餐</div>'),function(){alert("a")},function(){$(c).parent().remove(),a.dialog.closebox()}),a.stopBubble(b)})},getPriceInfo:function(){var a=[];$(".price-info .btn-outline").each(function(b,c){JSON.parse(c.attr("data-tc"));a.push(tc)});var b={tcs:a,updatedSKU:updatedSKU,deletedSKU:deletedSKU,limit:$(".day-limit").val()||0};return b}},module.exports=new c});
/*! PC_JX xiongzhaoling 最后修改于： 2016-11-01 */